!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("hp-components",["exports","@angular/core","rxjs","@angular/common"],t):t(e["hp-components"]={},e.ng.core,e.rxjs,e.ng.common)}(this,function(e,s,l,t){"use strict";var r=function(){function e(){}return e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),p=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.left=e,this.top=t,this.width=r,this.height=n}return Object.defineProperty(e.prototype,"right",{get:function(){return this.left+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.height+this.width===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new a(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new a(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new a(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new a(this.right,this.bottom)},enumerable:!0,configurable:!0}),e}(),c=function B(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.height=e,this.width=t},a=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.add=function(e){this.x=this.x+e.x,this.y=this.y+e.y},e.prototype.subtract=function(e){this.x=this.x-e.x,this.y=this.y-e.y},e}();function o(e){var t=e.getBoundingClientRect(),r=t.top,n=t.left;return new a(n,r)}function h(e){if(!e||0===e.length)return 0;var t=e.replace("px","").replace("em","");return parseFloat(t)}function n(e,t,n){void 0===n&&(n=[]);var i=[];return function s(e,t){void 0===t&&(t=!1);var r=new Array;if(!e)return r;for(var n=e.children,i=0;i<n.length;i++){var o=n[i];o&&o.parentElement===e&&-1===o.className.indexOf("hpc-lasso-selector")&&-1===o.className.indexOf("hpc-element-selector")&&-1===o.className.indexOf("grip")&&r.push(o)}return r}(e).forEach(function(e){(function r(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom})(d(e),t)&&(null!=n&&-1!==n.indexOf(e)||i.push(e))}),i}function u(e){var t=getComputedStyle(e,null);return new a(h(t.left),h(t.top))}function d(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=null);var n=u(e);t&&(n=f(e));var i=function o(e){var t=getComputedStyle(e,null);return new c(h(t.height),h(t.width))}(e);return r&&(i.width=i.width*r.x,i.height=i.height*r.y),new p(n.x,n.y,i.width,i.height)}function f(e){var t=u(e);if(null==e.parentElement)return t;var r=t.x,n=t.y;return function o(e,t,r){void 0===t&&(t="surface");void 0===r&&(r=!1);var n=new Array;if(!e)return n;var i=e.parentElement;for(;null!=i&&(r||!i.classList.contains(t))&&(n.push(i),!i.classList.contains(t));)i=i.parentElement;return n}(e).forEach(function(e){r+=h(e.style.left)+e.clientLeft,n+=h(e.style.top)+e.clientTop}),new a(r,n)}function g(e,t,r){var n=d(t),i=n.top,o=n.left;e.setStyle(r,"top",i+"px"),e.setStyle(r,"left",o+"px"),e.setStyle(r,"height",n.height+"px"),e.setStyle(r,"width",n.width+"px")}function y(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=[]);var n=[];return e&&(function s(e){for(var t=e.length-1;0<=t;t--){var r=e[t];(-1<r.className.indexOf("hpc-lasso-selector")||-1<r.className.indexOf("hpc-element-selector")||-1<r.className.indexOf("hpc-drag-overlay")||-1<r.className.indexOf("grip-container")||-1<r.className.indexOf("grip"))&&(n=e,void 0,-1<(o="number"==typeof(i=r)?i:n.indexOf(i))&&n.splice(o,1))}var n,i,o}(n=t?Array.from(e.querySelectorAll("*")):Array.from(e.children)),n=n.filter(function(e){return!(e in r)})),n}function v(e,t){return e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom}function m(e){return!S(e)&&-1===e.className.indexOf("hpc-no-drag")}function i(e){return!S(e)&&-1===e.className.indexOf("hpc-no-size")}function S(e){return-1<e.className.indexOf("hpc-locked")}var b=function(){function e(){this.dragCursor="move"}return e.prototype.createDragOverlay=function(e){var t=e.cloneNode(!0);return this.renderer.addClass(t,"hpc-drag-overlay"),this.renderer.setStyle(t,"cursor",this.dragCursor),this.renderer.setStyle(t,"zIndex",1e4),t},e.prototype.dragElementsBy=function(t,e){var r=this;e.forEach(function(e){e&&function s(e,t,r){if(t){var n=u(t),i=n.y+r.y,o=n.x+r.x;e.setStyle(t,"top",i+"px"),e.setStyle(t,"left",o+"px")}}(r.renderer,e,t)})},e.prototype.canDrag=function(e){return m(e)},e.prototype.findDropZone=function(e,t,r){if(void 0===r&&(r=[]),!e)return null;r.push(e);var n=function a(e,t,r){void 0===r&&(r=[]);for(var n=t,i=y(t,!1,r),o=0;o<i.length;o++){var s=i[o],l=s.getBoundingClientRect(),c=new p(l.left,l.top,l.width,l.height);if(-1===r.indexOf(s)&&v(e,c)){n=a(e,s,r);break}}return n}(o(e),t,r);return n!==t&&n.classList.contains("hpc-dropzone")?n:null},e.prototype.updateDropZone=function(e,t,r){void 0===r&&(r=[]),this.clearDropZones(t);var n=this.findDropZone(e,t,r);return n&&this.renderer.addClass(n,"active"),n},e.prototype.clearDropZones=function(e){var t=this;y(e,!0).forEach(function(e){t.renderer.removeClass(e,"active")})},e.prototype.dropElement=function(e,t,r){try{!function l(e,t,r){if(t&&e.parentElement!==t){var n=f(t),i=f(e),o=new a(i.x-n.x,i.y-n.y);r.appendChild(t,e),function s(e,t,r){t&&(e.setStyle(t,"top",r.y+"px"),e.setStyle(t,"left",r.x+"px"))}(r,e,o)}}(t,e,this.renderer)}catch(n){console.log(n)}},e.prototype.ngOnDestroy=function(){this.renderer=null},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[]},e}(),E=function(){function e(){this.minHeight=40,this.minWidth=40,this.orientations=["tb","rl"]}return Object.defineProperty(e.prototype,"isHorizontalSizing",{get:function(){return"lm"===this.gripKey||"rm"===this.gripKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVerticalSizing",{get:function(){return"tm"===this.gripKey||"bm"===this.gripKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSizingFromTop",{get:function(){return"tl"===this.gripKey||"tm"===this.gripKey||"tr"===this.gripKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSizingFromLeft",{get:function(){return"tl"===this.gripKey||"lm"===this.gripKey||"bl"===this.gripKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRotating",{get:function(){return"rotate"===this.gripKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this.gripKey.substr(0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverseOrientation",{get:function(){var t=this.orientation;return this.orientations.find(function(e){return e.includes(t)}).replace(t,"")},enumerable:!0,configurable:!0}),e.prototype.removeSizingGrips=function(t,r){Array.from(t.children).forEach(function(e){-1<e.className.indexOf("grip-container")&&r.removeChild(t,e)})},e.prototype.createSizingOverlay=function(e){var t=e.cloneNode(!1);return this.renderer.addClass(t,"hpc-sizer-overlay"),this.renderer.setStyle(t,"border-style","solid"),this.renderer.setStyle(t,"cursor","inherit"),t},e.prototype.sizeElementsBy=function(t,e){var r=this;e.forEach(function(e){r.sizeElementBy(t,e)})},e.prototype.sizeElementBy=function(e,t){var r=d(t),n=r.height+e.y,i=r.width+e.x,o=r.left,s=r.top;this.isSizingFromTop&&(s=r.top+e.y,n=r.height-e.y,"tm"===this.gripKey&&(i=r.width)),this.isSizingFromLeft&&(o=r.left+e.x,i=r.width-e.x,"lm"===this.gripKey&&(n=r.height)),this.isHorizontalSizing&&(n=r.height),this.isVerticalSizing&&(i=r.width);var l=new p(o,s,i,n);(i<this.minWidth||n<this.minHeight)&&(l=r),function c(e,t,r){e.setStyle(r,"top",t.top+"px"),e.setStyle(r,"left",t.left+"px"),e.setStyle(r,"height",t.height+"px"),e.setStyle(r,"width",t.width+"px")}(this.renderer,l,t)},e.prototype.prepareToSize=function(){},e.prototype.canSize=function(e){return i(e)},e.prototype.addSizingGrips=function(e,t){t.setProperty(e,"innerHTML",'\n      <div class="grip-container">\n        <div class="grip-container-l">\n          <div gripKey="tl" class="grip grip-tl"></div>\n          <div gripKey="lm" class="grip grip-lm"></div>\n          <div gripKey="bl" class="grip grip-bl"></div>\n        </div>\n        <div class="grip-container-m">\n          <div gripKey="tm" class="grip grip-tm"></div>\n          <div gripKey="bm" class="grip grip-bm"></div>\n        </div>\n        <div class="grip-container-r">\n          <div gripKey="tr" class="grip grip-tr"></div>\n          <div gripKey="rm" class="grip grip-rm"></div>\n          <div gripKey="br" class="grip grip-br"></div>\n        </div>\n      </div>\n     ')},e.prototype.ngOnDestroy=function(){this.renderer=null},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[]},e}(),_={Draggable:0,Sizable:1,Idle:2};_[_.Draggable]="Draggable",_[_.Sizable]="Sizable",_[_.Idle]="Idle";var x={Overlay:0,Selector:1};x[x.Overlay]="Overlay",x[x.Selector]="Selector";var w=function(){function e(e,t,r,n){this._sizeService=e,this._dragService=t,this._componentFactoryResolver=r,this._injector=n,this._lassoSelector=null,this._selectors=new Array,this.lassoCursor="crosshair",this.shouldAllowSizing=!0,this.isLassoSelectable=!0}return Object.defineProperty(e.prototype,"activeSelector",{get:function(){return this._activeSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this.state!==_.Idle&&this.createSelectionOverlays())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasLasso",{get:function(){return null!==this._lassoSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasElementSelectors",{get:function(){return 0<Array.from(this._selectors.entries()).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectors",{get:function(){return this._selectors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorElements",{get:function(){return this.selectors.map(function(e){return e.selectorEl})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clients",{get:function(){return this.selectors.map(function(e){return e.clientEl})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectableElements",{get:function(){return y(this.interactionHost).filter(function(e){return function t(e){return!e.classList.contains("hpc-no-select")}(e)})},enumerable:!0,configurable:!0}),e.prototype.createlassoSelector=function(e,t){if(this.clearSelectors(),this.isLassoSelectable){var r=this.createSelector(e,t,this.interactionHost);this.renderer.setStyle(this.interactionHost,"cursor",this.lassoCursor),this.renderer.addClass(r,"hpc-lasso-selector"),this._lassoSelector=r}},e.prototype.removelassoSelector=function(){this._lassoSelector&&(this.renderer.removeChild(this.interactionHost,this._lassoSelector),this._lassoSelector=null)},e.prototype.selectorAtPoint=function(e){for(var t=0;t<this.selectors.length;t++){var r=this.selectors[t],n=r.selectorEl.getBoundingClientRect();if(v(e,new p(n.left,n.top,n.width,n.height)))return r}},e.prototype.selectCapturedElements=function(){var t=this,e=d(this._lassoSelector);n(this.interactionHost,e,[this._lassoSelector]).forEach(function(e){t.selectElement(e,!1,t.shouldAllowSizing)}),this.removelassoSelector()},e.prototype.unSelectAll=function(){this.clearSelectors()},e.prototype.unSelectElement=function(t){var e=this.selectors.find(function(e){return e.clientEl===t});e&&this.clearSelector(e)},e.prototype.selectAll=function(){var t=this;this.clearSelectors(),this.selectableElements.forEach(function(e){t.selectElement(e,!1)})},e.prototype.selectElement=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var n=this.selectors.find(function(e){return e.selectorEl===t||e.clientEl===t||e.overlay===t});if(t.hasAttribute("gripKey")){n=this.selectors.find(function(e){return e.selectorEl===t.parentElement.parentElement.parentElement});var i=getComputedStyle(t).cursor;return this.renderer.setStyle(this.interactionHost,"cursor",i),this._sizeService.gripKey=t.getAttribute("gripKey"),void(this.state=_.Sizable)}if(n)return this.state=_.Idle,void(this._activeSelector=n);e&&this.clearSelectors();var o=d(t),s=this.createSelector(o.left,o.top,t.parentElement);s.isSelector=!0,g(this.renderer,t,s),this.renderer.addClass(s,"hpc-element-selector"),n={clientEl:t,selectorEl:s,overlay:null},this._selectors.push(n),this._activeSelector=n,r&&this._sizeService.canSize(t)&&this._sizeService.addSizingGrips(s,this.renderer),m(t)&&this.renderer.setStyle(this.interactionHost,"cursor","move"),this.state=_.Idle},e.prototype.createSelectionOverlays=function(){var t=this;this.selectors.forEach(function(e){t._sizeService.removeSizingGrips(e.selectorEl,t.renderer),e.overlay&&t.renderer.removeChild(e.selectorEl.parentElement,e.overlay),t.state===_.Sizable&&t._sizeService.canSize(e.clientEl)?e.overlay=t._sizeService.createSizingOverlay(e.selectorEl):t.state===_.Draggable&&t._dragService.canDrag(e.clientEl)&&(e.overlay=t._dragService.createDragOverlay(e.clientEl)),e.overlay&&t.renderer.appendChild(e.selectorEl.parentElement,e.overlay)})},e.prototype.createSelector=function(e,t,r){var n=this.renderer.createElement("div");return this.renderer.appendChild(r,n),this.renderer.setStyle(n,"position","absolute"),this.renderer.setStyle(n,"left",e+"px"),this.renderer.setStyle(n,"top",t+"px"),this.renderer.setStyle(n,"boxSizing","border-box"),this.renderer.setStyle(n,"zIndex","10000"),n},e.prototype.clearSelectors=function(){var t=this;this.removelassoSelector(),Array.from(this._selectors.values()).forEach(function(e){t.clearSelector(e)}),this._selectors=[]},e.prototype.clearSelector=function(e){e===this._activeSelector&&(this._activeSelector=null),this.renderer.removeChild(e.selectorEl.parentElement,e.selectorEl),e.overlay&&this.renderer.removeChild(e.overlay.parentElement,e.overlay),this.selectors.splice(this.selectors.indexOf(e),1)},e.prototype.resizeLasso=function(e,t,r){if(t<0){t=Math.abs(t);var n=r.y-t;this.renderer.setStyle(this._lassoSelector,"top",n+"px")}if(e<0){e=Math.abs(e);var i=r.x-e;this.renderer.setStyle(this._lassoSelector,"left",i+"px")}this.renderer.setStyle(this._lassoSelector,"height",t+"px"),this.renderer.setStyle(this._lassoSelector,"width",e+"px")},e.prototype.resizeSelectorsBy=function(e){var t=this.selectors.map(function(e){return e.selectorEl});this._sizeService.sizeElementsBy(e,t)},e.prototype.resizeOverlaysBy=function(e){var t=this.selectors.map(function(e){return e.overlay});this._sizeService.sizeElementsBy(e,t)},e.prototype.moveSelectorsBy=function(e){var t=this.selectors.map(function(e){return e.overlay});this._dragService.dragElementsBy(e,t)},e.prototype.moveOverlaysBy=function(e){var t=this.selectors.map(function(e){return e.overlay});this._dragService.dragElementsBy(e,t)},e.prototype.reselect=function(){var t=this,e=this.clients;this.clearSelectors(),e.forEach(function(e){t.selectElement(e,!1,t.shouldAllowSizing)})},e.prototype.nudgeBy=function(e,t){0===e.x&&0===e.y||(this.state===_.Sizable?(t===x.Selector&&this.resizeSelectorsBy(e),t===x.Overlay&&this.resizeOverlaysBy(e)):this.state===_.Draggable?(t===x.Selector&&this.moveSelectorsBy(e),t===x.Overlay&&this.moveOverlaysBy(e)):this.state=_.Draggable)},e.prototype.ngOnDestroy=function(){this.clearSelectors(),this.renderer=null,this.interactionHost=null},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:E},{type:b},{type:s.ComponentFactoryResolver},{type:s.Injector}]},e}(),z=function(){function e(e){this._selectionService=e,this._deleteElementSubject=new l.Subject,this.deleteElement$=this._deleteElementSubject.asObservable(),this._deleteElementsSubject=new l.Subject,this.deleteElements$=this._deleteElementSubject.asObservable(),this._deleteSelectedElementsSubject=new l.Subject,this.deleteSelectedElements$=this._deleteSelectedElementsSubject.asObservable(),this._addElementSubject=new l.Subject,this.addElement$=this._addElementSubject.asObservable(),this._selectedElementsSubject=new l.BehaviorSubject(null),this.selectedElements$=this._selectedElementsSubject.asObservable(),this._selectedElements=[]}return Object.defineProperty(e.prototype,"selectedElements",{get:function(){return this._selectedElements},set:function(e){this._selectedElements=e,this._selectedElementsSubject.next(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasSelectedElements",{get:function(){return this._selectedElements&&0<this._selectedElements.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canSelectElements",{get:function(){return 0<this._selectionService.selectableElements.length},enumerable:!0,configurable:!0}),e.prototype.deleteElement=function(e){this.renderer.removeChild(e.parentElement,e),this._deleteElementSubject.next(e)},e.prototype.deleteElements=function(e){var t=this;e.forEach(function(e){t.renderer.removeChild(e.parentElement,e)}),this._deleteElementsSubject.next(e)},e.prototype.deleteSelectedElements=function(){this._deleteSelectedElementsSubject.next()},e.prototype.deleteAll=function(){this._selectionService.unSelectAll();for(var e=y(this.interactionHost),t=e.length-1;0<=t;t--){var r=e[t];this.renderer.removeChild(this.interactionHost,r)}},e.prototype.addElement=function(e){void 0===e&&(e=null),e||(e=this.renderer.createElement("div"),this.renderer.addClass(e,"hpc-new-element")),this.renderer.setStyle(e,"box-sizing","border-box"),this.renderer.setStyle(e,"position","absolute"),this.renderer.appendChild(this.interactionHost,e),this._selectionService.selectElement(e),this.interactionHost.focus(),this._addElementSubject.next(e)},e.prototype.addContainer=function(e){void 0===e&&(e=null),e||(e=this.renderer.createElement("div"),this.renderer.addClass(e,"hpc-new-element")),this.renderer.addClass(e,"hpc-dropzone"),this.renderer.addClass(e,"hpc-container"),this.addElement(e)},e.prototype.selectAll=function(){this._selectionService.selectAll(),this.selectedElements=this._selectionService.clients},e.prototype.unSelectAll=function(){this._selectionService.unSelectAll(),this.selectedElements=this._selectionService.clients},e.prototype.ngOnDestroy=function(){this.renderer=null},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:w}]},e}(),O=function(){function e(e,t,r,n,i){var o=this;this._renderer=e,this._dragService=t,this._sizeService=r,this._interactionService=n,this._selectionService=i,this._isMouseDown=!1,this._mouseDownPos=new a,this._keyDownSubject=new l.Subject,this.scale=1,this.snap=0,this.minSizingWidth=30,this.minSizingHeight=30,this.isLassoSelectable=!0,this.isCheckersBackground=!1,this.resizedElement=new s.EventEmitter,this.resizedElements=new s.EventEmitter,this.movedElement=new s.EventEmitter,this.movedElements=new s.EventEmitter,this.selectElement=new s.EventEmitter,this.canDelete=function(){return!0},this.canDrop=function(){return!0},this._selectionService.renderer=this._renderer,this._sizeService.renderer=this._renderer,this._dragService.renderer=this._renderer,this._interactionService.renderer=this._renderer,this._keyDownSubject.subscribe(function(e){return o.keyDownHandler(e)})}return e.prototype.keyUp=function(e){"Delete"===e.code&&0<this._selectionService.selectors.length&&this.deleteSelectedElements()},e.prototype.keyPress=function(e){0<this._selectionService.selectors.length&&e.stopPropagation()},e.prototype.keyDown=function(e){this._keyDownSubject.next(e)},e.prototype.keyDownHandler=function(e){if(0<this._selectionService.selectors.length){var t=void 0,r=this.snap?this.snap:1;if("Escape"===e.code&&this.cancelSelection(),e.shiftKey)if(e.ctrlKey)e.code;else{switch(t=new a,e.code){case"ArrowLeft":t=new a(-r,0);break;case"ArrowUp":t=new a(0,-r);break;case"ArrowRight":t=new a(r,0);break;case"ArrowDown":t=new a(0,r)}this._sizeService.gripKey="keyboard",this._sizeService.sizeElementsBy(t,this._selectionService.selectorElements),this._sizeService.sizeElementsBy(t,this._selectionService.clients)}else{switch(t=new a,e.code){case"ArrowLeft":t=new a(-r,0);break;case"ArrowUp":t=new a(0,-r);break;case"ArrowRight":t=new a(r,0);break;case"ArrowDown":t=new a(0,r)}this._dragService.dragElementsBy(t,this._selectionService.selectorElements),this._dragService.dragElementsBy(t,this._selectionService.clients)}}},e.prototype.dragStart=function(){return!1},e.prototype.pointerMove=function(e){if(e.preventDefault(),this._isMouseDown){var t=this.getRelativePointerPos(e);if(this._selectionService.hasLasso){var r=this._mouseDownPos;this._selectionService.resizeLasso(t.x-r.x,t.y-r.y,r)}else if(0<this._selectionService.selectors.length){var n=this.getPointerChange(e);this._selectionService.nudgeBy(n[0],x.Overlay),t=n[1],this._lastDropZone=this._dragService.updateDropZone(this._selectionService.activeSelector.overlay,this._el.nativeElement,[this._selectionService.activeSelector.clientEl])}this._lastMousePos=t}else this.ensureCursor(e)},e.prototype.pointerDown=function(e){if(this._isMouseDown=!0,this._mouseDownPos=this.getRelativePointerPos(e),this._lastMousePos=this._mouseDownPos,e.target===this._el.nativeElement)this._selectionService.createlassoSelector(this._mouseDownPos.x,this._mouseDownPos.y);else{var t=e.target;this._selectionService.selectElement(t,!e.shiftKey)}},e.prototype.pointerUp=function(e){this._isMouseDown=!1,this._selectionService.hasLasso?this._selectionService.selectCapturedElements():(this._selectionService.state===_.Draggable?(this.moveSelectedElements(x.Overlay,!1),this.tryDropSelectedElements()):this._selectionService.state===_.Sizable&&this.resizeSelectedElements(),this._dragService.clearDropZones(this._el.nativeElement)),this._renderer.setStyle(this._el.nativeElement,"cursor",this._cursor),this._lastDropZone=null,this._interactionService.selectedElements=this._selectionService.clients},e.prototype.tryDropSelectedElements=function(){var t=this;this._selectionService.selectors.forEach(function(e){t.canDrop(e.clientEl)&&t._dragService.dropElement(t._lastDropZone,e.clientEl,t._el.nativeElement)}),this._selectionService.reselect()},e.prototype.ensureCursor=function(e){var t=new a(e.pageX,e.pageY),r=this._selectionService.selectorAtPoint(t);r&&m(r.clientEl)?this._renderer.setStyle(this._el.nativeElement,"cursor","move"):this._renderer.setStyle(this._el.nativeElement,"cursor","default")},e.prototype.resizeSelectedElements=function(){var t=this,e=this._selectionService.selectors,r=[];e.forEach(function(e){i(e.clientEl)&&(r.push(e.clientEl),g(t._renderer,e.overlay,e.clientEl),t.resizedElement.emit(e.clientEl))}),this.resetSelection(),0<r.length&&this.resizedElements.emit(r)},e.prototype.moveSelectedElements=function(t,e){var r=this;void 0===t&&(t=x.Overlay),void 0===e&&(e=!0);var n=this._selectionService.selectors,o=[];n.forEach(function(e){m(e.clientEl)&&(o.push(e.clientEl),function i(e,t,r){d(t);var n=u(t);e.setStyle(r,"top",n.y+"px"),e.setStyle(r,"left",n.x+"px")}(r._renderer,t===x.Overlay?e.overlay:e.selectorEl,e.clientEl),r.movedElement.emit(e.clientEl))}),e&&this.resetSelection(),0<o.length&&this.movedElements.emit(o)},e.prototype.deleteSelectedElements=function(){for(var e=this._selectionService.selectors,t=[],r=e.length-1;0<=r;r--){var n=e[r];if(this.canDelete(n.clientEl)){var i=n.clientEl;this._selectionService.clearSelector(n),this._interactionService.deleteElement(i),t.push(i)}}this._interactionService.deleteElements(t),this._interactionService.selectedElements=this._selectionService.clients},e.prototype.addElement=function(e){var t=this._selectionService.activeSelector,r=t&&function n(e){return e.classList.contains("hpc-container")}(t.clientEl)?t.clientEl:this._el.nativeElement;this._renderer.appendChild(r,e)},e.prototype.getRelativePointerPos=function(e){return function i(e,t,r){void 0===r&&(r=1);var n=o(t);return new a((e.pageX-n.x)/r,(e.pageY-n.y)/r)}(e,this._el.nativeElement,this.scale)},e.prototype.getPointerChange=function(e){var t=this.getRelativePointerPos(e),r=t.x-this._lastMousePos.x,n=t.y-this._lastMousePos.y;return this.snap&&(r%this.snap!=0&&(r=0,t.x=this._lastMousePos.x),n%this.snap!=0&&(n=0,t.y=this._lastMousePos.y)),[new a(r,n),t]},e.prototype.resetSelection=function(){this._selectionService.reselect()},e.prototype.cancelSelection=function(){this._isMouseDown?this._selectionService.reselect():this._selectionService.clearSelectors()},e.prototype.ngOnInit=function(){var e=this;this._el.nativeElement&&this._renderer&&(this._interactionService.interactionHost=this._el.nativeElement,this._selectionService.interactionHost=this._el.nativeElement,this._selectionService.isLassoSelectable=this.isLassoSelectable,this._cursor=getComputedStyle(this._el.nativeElement).cursor,this._deleteSelectedElementsSubscription=this._interactionService.deleteSelectedElements$.subscribe(function(){e.deleteSelectedElements()}),this._addElementSubscription=this._interactionService.addElement$.subscribe(function(e){}))},e.prototype.ngOnDestroy=function(){this._lastDropZone=null,this._deleteSelectedElementsSubscription.unsubscribe(),this._addElementSubscription.unsubscribe()},e.decorators=[{type:s.Component,args:[{selector:"hpc-interaction",template:'<div #interactionContainer tabindex="0" (dragstart)="dragStart()" (pointerdown)="pointerDown($event)" (pointerup)="pointerUp($event)"\r\n  (pointermove)="pointerMove($event)" (keydown)="keyDown($event)" (keyup)="keyUp($event)" (keypress)="keyPress($event)"\r\n  [style.transform]="\'scale(\'+scale+\')\'" [ngClass]="{\'hpc-checkers-background\': isCheckersBackground}" class="interaction-container">\r\n  <ng-content></ng-content>\r\n</div>\r\n',encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush,styles:[':host{box-sizing:border-box;position:absolute;height:100%;width:100%}.hpc-new-element{background-color:gray;top:10px;left:10px;height:200px;width:400px;border:1px solid #000}.interaction-container{height:100%;box-sizing:border-box;background:0 0}.hpc-checkers-background{background:url(\'data:image/svg+xml,\\<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" fill-opacity=".25" >            <rect x="200" width="200" height="200" />            <rect y="200" width="200" height="200" />            </svg>\') 0 0/20px 20px gray}.hpc-element-selector,.hpc-lasso-selector{border:2px dashed #000;pointer-events:None}.grip-container{pointer-events:None;height:100%;width:100%;display:flex}.grip-container-l,.grip-container-m,.grip-container-r{display:flex;flex-direction:column;justify-content:space-between;flex:1}.grip-container-l{align-items:flex-start}.grip-container-m{align-items:center}.grip-container-r{align-items:flex-end}.grip{--grip-offset:-9px;background-color:#f2f2f2;border:2px solid #000;height:13px;width:13px;opacity:.85}.grip-bl,.grip-bm,.grip-br,.grip-lm,.grip-rm,.grip-tl,.grip-tm,.grip-tr{pointer-events:auto}.grip-tl{margin-left:var(--grip-offset);margin-top:var(--grip-offset);cursor:nw-resize}.grip-tm{margin-top:var(--grip-offset);cursor:n-resize}.grip-bm{margin-bottom:var(--grip-offset);cursor:n-resize}.grip-tr{margin-top:var(--grip-offset);margin-right:var(--grip-offset);cursor:ne-resize}.grip-br{cursor:nw-resize;margin-right:var(--grip-offset);margin-bottom:var(--grip-offset)}.grip-rm{cursor:e-resize;margin-right:var(--grip-offset)}.grip-bl{cursor:ne-resize;margin-left:var(--grip-offset);margin-bottom:var(--grip-offset)}.grip-lm{cursor:e-resize;margin-left:var(--grip-offset)}.grip-bl,.grip-br,.grip-tl,.grip-tr{border-radius:50%}.hpc-sizer-overlay{z-index:10000}.hpc-drag-overlay{opacity:.5;z-index:10000}.hpc-dropzone.active{border:2px dashed #fff}']}]}],e.ctorParameters=function(){return[{type:s.Renderer2},{type:b},{type:E},{type:z},{type:w}]},e.propDecorators={_el:[{type:s.ViewChild,args:["interactionContainer"]}],scale:[{type:s.Input}],snap:[{type:s.Input}],minSizingWidth:[{type:s.Input}],minSizingHeight:[{type:s.Input}],isLassoSelectable:[{type:s.Input}],isCheckersBackground:[{type:s.Input}],resizedElement:[{type:s.Output}],resizedElements:[{type:s.Output}],movedElement:[{type:s.Output}],movedElements:[{type:s.Output}],selectElement:[{type:s.Output}],canDelete:[{type:s.Input}],canDrop:[{type:s.Input}]},e}(),P=function(){function e(){this.headerVisible=!0}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-composer",template:'<div class="composer_container">\n    <div *ngIf="headerVisible" class="header-row">\n       <ng-content select="[header]"></ng-content>\n    </div>\n    <div class= "body-row">\n      <div class="composer_container-widgets">\n          <ng-content select="[widgets]"></ng-content>\n      </div>\n      <div class="composer-main-container">\n        <div class="composer-menu-container">\n           <ng-content select="[menu]"></ng-content>\n        </div>\n        <hpc-interaction [isCheckersBackground]=true [isLassoSelectable]=true [scale]=0.65>\n          \x3c!-- sample elements - will remove in production version  --\x3e\n          <div class="hpc-dropzone" style="position: absolute; top: 400px; left: 100px; height: 200px; width:400px; background: orangered">\n            <div style="position: absolute; top: 10px; left: 10px; height: 180px; width:200px; background: yellow">\n              <div class="hpc-dropzone" style="position: absolute; top: 10px; left: 10px; height: 100px; width:100px; background: rgb(0, 255, 0)"></div>\n            </div>\n          </div>\n          <div class="hpc-no-drag hpc-no-size" style="position: absolute; left: 600px; top: 100px; height: 600px; width:500px; background: rgb(15, 94, 88)"></div>\n          \x3c!-- end sample elements --\x3e\n        </hpc-interaction>\n      </div>\n      <div class="composer_container-properties"></div>\n    </div>\n</div>\n\n',styles:[":host /deep/ .interaction-container{height:1080px;width:1920px;-webkit-transform-origin:left top;transform-origin:left top;margin-left:33px;margin-top:2%}.composer_container{display:flex;flex-direction:column;overflow:hidden}.composer_container>*{--container-background:rgb(35, 36, 35);--container-header:rgb(63, 63, 63);--container-header-color:rgb(29, 202, 38);--container-main:rgb(63, 63, 63)}.composer_container-widgets{display:flex;flex-direction:column;width:300px;background-color:var(--container-background)}.composer_container-properties{width:300px;background-color:var(--container-background)}.composer-main-container{overflow:auto;background-color:var(--container-main);height:100%;display:flex;flex-direction:column;flex:1}.composer-menu-container{color:#fff;padding:10px;min-height:75px;width:100%}.header-row{display:flex;flex-wrap:wrap;height:75px;background:gray}.body-row{display:flex;height:100%;width:100%}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={headerVisible:[{type:s.Input}]},e}(),j=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-treeview",template:"<p>\n  treeview works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),D=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-treeview-item",template:"<p>\n  treeview-item works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),C=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-selector",template:"<p>\n  selector works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),k=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-file-manager",template:"<p>\n  file-manager works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),I=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:s.Component,args:[{selector:"hpc-property-grid",template:"<p>\n  property-grid works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),A=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[t.CommonModule],declarations:[O,P,j,D,C,k,I],exports:[O,P,j],providers:[b,E,z,w]}]}],e}();e.HpComponentsService=r,e.HpComponentsModule=A,e.InteractionService=z,e.InteractionComponent=O,e.ɵd=P,e.ɵh=k,e.ɵi=I,e.ɵg=C,e.ɵc=w,e.ɵa=b,e.ɵb=E,e.ɵf=D,e.ɵe=j,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=hp-components.umd.min.js.map